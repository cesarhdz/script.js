<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Remote Script DeMO</title>
    <script src="remoteScript.js" type="text/javascript"></script>
</head>
<body>

<h1>Remote Script DeMO</h1>

<script type="text/javascript">
    var removeEmbedStyleLink = function(script, writeArray) {
        var gist = script.src.indexOf('gist.github.com') != -1; // or pastie
        var linksCount = gist ? 1 : 2; // pastie has clean.css besides embed.css
        if ( writeArray ) { // onLoad - writeArray contains all document.writes
            var i = -1;
            while ( writeArray[++i] && linksCount ) {
                var str = writeArray[i].replace(/^\s*/, "");
                str = str.substring(0, 5).toLowerCase();
                if (str == '<link') {
                    writeArray[i] = ''; linksCount--;
                }
            }
        }
        else { // loaded in-place - links are already in the DOM
          var removeSiblingLink = function($elem) {
              while ($elem && $elem.nodeName.toLowerCase() != 'link') {
                  $elem = $elem.nextSibling;
              }
              if ( $elem ) $elem.parentNode.removeChild($elem);
          }
          var startNode = script.nextSibling;
          if ( ! gist ) {
              while (startNode.className != 'pastie') {
                  startNode = startNode.nextSibling;
              }
          }
          for ( var i=0; i<linksCount; i++ ) {
              removeSiblingLink(gist ? startNode : startNode.firstChild);
          }
        }
    }

    remoteScript.defaults.onLoad = true;
    remoteScript.defaults.scriptLoaded = removeEmbedStyleLink;
    remoteScript.defaults.base = 'http://gist.github.com';
</script>

<h3>1 BEG</h3>
    <script type="text/javascript">remoteScript({ src: '264891.js', onLoad: false });</script>
<h3>1 END</h3>

<h3>2 + 3 BEG</h3>
    <script type="text/javascript">
      remoteScript({ src: 'http://pastie.org/848365.js', loadingHTML: '<h4>... LOADING PASTIE ...</h4>' });
      document.write('<h4>delimiter</h4>');
      remoteScript('313463.js');
    </script>
<h3>2 + 3 END</h3>

<script type="text/javascript">
    remoteScript({ src: 'http://gist.github.com/319433.js', appendScript: 'putGistHere' });
</script>

<h3>4 BEG</h3>
    <div id="putGistHere"></div>
<h3>4 END</h3>

<script type="text/javascript">
    remoteScript.defaults.base = null;
    remoteScript.defaults.scriptLoaded = null;
</script>

<button  onclick="remoteScript('http://gist.github.com/218254.js');">
    Add a GIST
</button>
<button  onclick="remoteScript('http://pastie.org/849505.js');">
    Add a PASTIE
</button>

<br/><br/>

</body>
</html>